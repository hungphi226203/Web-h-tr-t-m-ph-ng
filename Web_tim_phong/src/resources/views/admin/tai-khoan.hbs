<div class="tai-khoan">
    <h3 style="text-align: center;">Danh sách tài khoản</h3>
    
        <form class="form-search timtk input-group"action="/admin/tai-khoan/timkiem" >
            <input type="text" class="form-control" placeholder="Nhập tên tài khoản" name="user">
            <span class="input-group-btn">
                <button class="btn btn-default" type="submit"><i class="bi bi-search "></i></button>
            </span>
        </form>
    
    <div class="ds-tk" style="margin-top:20px">
        <table class="table table-success table-striped-columns">
            <thead>
                <tr>
                    <th scope="col" style="width:60%">Tên tài khoản</th>
                    <th scope="col">Thông tin</th>
                    <th scope="col">Quyền</th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody>
                {{#if accounts}}
                    {{#each accounts}}
                        <tr>
                            <td><div style="margin-left: 20px;margin-top:5px">{{this.username}}</div></td>
                            <td>
                                <button type="button" class="btn btn-outline-dark btn-thongtin">Thông tin</button>
                                <div class="popupForm popup">
                                    <div class="popup-content form-control">
                                        <span class="closeBtn">&times;</span>
                                        <h2 style="text-align:center">Thông tin</h2>
                                        <label for="fullname">Họ và tên</label>
                                        <input class="form-control" id="fullname" value="{{this.fullname}}" readonly />
                                        <label for="id_card">CCCD</label>
                                        <input class="form-control" id="id_card" value="{{this.id_card}}" readonly/>
                                        <label for="phone">Số điện thoại</label>
                                        <input class="form-control" id="phone" value="{{this.phone}}" readonly/>
                                        <label for="email">Email</label>
                                        <input class="form-control" id="email" value="{{this.email}}" readonly/>
                                        <label for="sodu">Số dư</label>
                                        <input class="form-control" id="sodu" value="{{this.acc_bala}} Đồng" readonly/>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <button  type="button" class="btn btn-outline-dark btn-quyen openModal">{{this.role}}</button>
                                <button style="display: none;" type="button" class="btnquyen-user ">{{this.username}}</button>
                                    <div class="modal">
                                    <div class="modalContent">
                                    <span class="close">×</span>
                                    <p class="p">Bạn có chắc là muốn thay đổi quyền của tài khoản này?</p>
                                    <button class="btnchuyen" >Xác nhận</button>
                                    <button class="btnhuy" >Hủy</button>
                                    </div>
                                    </div>
                            </td>
                            <td>
                                <button type="button" class="btn btn-danger btn-xoa openModal1">Xóa</button>
                                <button style="display: none;" type="button" class="btnquyen-user1 ">{{this.username}}</button>
                                <div class="modal1">
                                    <div class="modalContent1">
                                    <span class="close1">×</span>
                                    <p class="p">Bạn có chắc là muốn xóa tài khoản này?</p>
                                    <button class="btnchuyen1" >Xác nhận</button>
                                    <button class="btnhuy1" >Hủy</button>
                                    </div>
                                    </div>
                            </td>
                        </tr>
                    {{/each}}
                {{else}}
                    <td>Không có tài khoản</td>
                {{/if}}
            </tbody>
        </table>
    </div>
</div>
<form class="form-quyen"></form>
<script>

    var btnThongTins = document.querySelectorAll(".btn-thongtin");
    var btnQuyens = document.querySelectorAll(".btn-quyen");
    var closeBtns = document.querySelectorAll(".closeBtn");
    

    btnThongTins.forEach(function(btnThongTin, index) {
        btnThongTin.style.marginLeft = "-10px";
        btnThongTin.onclick = function() {
            var popupForm = document.querySelectorAll(".popupForm")[index];
            popupForm.style.display = "block";
        };
    });

    closeBtns.forEach(function(closeBtn) {
        closeBtn.onclick = function() {
            var popupForm = closeBtn.closest(".popupForm");
            popupForm.style.display = "none";
        };
    });

    btnQuyens.forEach(function(btnQuyen) {
        btnQuyen.style.marginLeft = "-10px";
        btnQuyen.style.width = "90%";
    });

   

    //quyen
    var modal = document.querySelector(".modal");
    var btns = document.querySelectorAll(".openModal");
    var spans = document.querySelectorAll(".close");
    var form_quyen=document.querySelector(".form-quyen");
    var btnquyen_users=document.querySelectorAll(".btnquyen-user");
    var btnchuyens=document.querySelectorAll(".btnchuyen");
    var btnhuys=document.querySelectorAll(".btnhuy");
    btns.forEach(function(btn, index) {
        btn.onclick = function() {
            var btnquyen_user = document.querySelectorAll(".btnquyen-user")[index];
            if(btn.innerHTML=="admin"){
                form_quyen.action="/admin/tai-khoan/quyen/"+btnquyen_user.innerHTML+"ad";
            }else{
                form_quyen.action="/admin/tai-khoan/quyen/"+btnquyen_user.innerHTML+"us";
            }
            modal.style.display = "block";
        };
    });
    spans.forEach(function(span) {
        span.onclick = function() {
            modal.style.display = "none";
        };
    });
    btnchuyens.forEach(function(btnchuyen) {
        btnchuyen.onclick = function() {
            
            form_quyen.submit();
        };
    });
    btnhuys.forEach(function(btnhuy) {
        btnhuy.onclick = function() {
            modal.style.display = "none";
        };
    });
   window.onclick = function(event) {
      if (event.target == modal) {
         hideModal();
      }
   };
   var modal1 = document.querySelector(".modal1");
    var btns1 = document.querySelectorAll(".openModal1");
    var spans1 = document.querySelectorAll(".close1");
    //var form_quyen=document.querySelector(".form-quyen");
    var btnchuyens1=document.querySelectorAll(".btnchuyen1");
    var btnhuys1=document.querySelectorAll(".btnhuy1");

    btns1.forEach(function(btn, index) {
        btn.onclick = function() {
            var btnquyen_user = document.querySelectorAll(".btnquyen-user1")[index];
            form_quyen.action="/admin/tai-khoan/xoa/"+btnquyen_user.innerHTML;
            modal1.style.display = "block";
        };
    });
    spans1.forEach(function(span) {
        span.onclick = function() {
            modal1.style.display = "none";
        };
    });
    btnchuyens1.forEach(function(btnchuyen) {
        btnchuyen.onclick = function() {
            form_quyen.submit();
        };
    });
    btnhuys1.forEach(function(btnhuy) {
        btnhuy.onclick = function() {
            modal1.style.display = "none";
        };
    });
</script>
